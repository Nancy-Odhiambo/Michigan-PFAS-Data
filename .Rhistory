title = "Site Type",
position = "bottomright",
shape = "circle",
width = 8,
height = 8,
fillOpacity = 0.8
)
#| label: sites_circle_map
# Convert pfas_sites to sf
pfas_sites_sf <- pfas_sites %>%
mutate(
type = str_replace_all(type, "mlitary", "military"),
type = str_to_title(type),
popup_label = paste0(
"<b>Facility:</b> ", facility, "<br>",
"<b>Type:</b> ", type, "<br>",
"<b>County:</b> ", county
)
)
# Load Michigan counties shapefile
mi_counties <- st_read("GeoFiles/cb_2018_us_county_500k.shp", quiet = TRUE) %>%
filter(STATEFP == "26") %>%
st_transform(4326)
# Defining shared data
# 'key' defines what makes a row unique; 'group' identifies the shared connection
shared_data <- SharedData$new(ncaa_arenas, key = ~team, group = "ncaa_map")
#| label: sites_circle_map
# Convert pfas_sites to sf
pfas_sites_sf <- pfas_sites %>%
mutate(
type = str_replace_all(type, "mlitary", "military"),
type = str_to_title(type),
popup_label = paste0(
"<b>Facility:</b> ", facility, "<br>",
"<b>Type:</b> ", type, "<br>",
"<b>County:</b> ", county
)
)
# Load Michigan counties shapefile
mi_counties <- st_read("GeoFiles/cb_2018_us_county_500k.shp", quiet = TRUE) %>%
filter(STATEFP == "26") %>%
st_transform(4326)
# Viridis discrete palette for type
pal <- colorFactor("viridis", pfas_sites_sf$type)
# Making the map
leaflet() %>%
setView(lng = -84.5, lat = 44.5, zoom = 5.5) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addPolygons(
data = mi_counties,
fillColor = "grey",
color = "black",
weight = 1,
fillOpacity = 0.3
) %>%
addCircleMarkers(
data = pfas_sites_sf,
lng = ~longitude, lat = ~latitude,
radius = 4,
fillColor = ~pal(type),
stroke = FALSE,
fillOpacity = 0.8,
popup = ~popup_label,
label = ~lapply(popup_label, htmltools::HTML)
) %>%
# Circle legend with matching size
addLegendFactor(
pal = pal,
values = pfas_sites_sf$type,
title = "Site Type",
position = "bottomright",
shape = "circle",
width = 8,
height = 8,
fillOpacity = 0.8
)
pfas_sites_sf |> janitor::tabyl(type) |> arrange(desc(n))
pfas_sites_sf |> janitor::tabyl(type) |> arrange(desc(n)) |> adorn_percentages()
pfas_sites_sf |> janitor::tabyl(type) |> arrange(desc(n)) |> adorn_totals()
#| label: sites_circle_map
# Convert pfas_sites to sf
pfas_sites_sf <- pfas_sites %>%
mutate(
type = str_replace_all(type, "mlitary", "military"),
type = str_to_title(type),
type = case_when(type %in% c("Tannery", "Unknown", "Refinery",
"Laundromat/Drycleaner", "Fire Station") ~ "Other",
TRUE ~ type),
popup_label = paste0(
"<b>Facility:</b> ", facility, "<br>",
"<b>Type:</b> ", type, "<br>",
"<b>County:</b> ", county
)
)
# Load Michigan counties shapefile
mi_counties <- st_read("GeoFiles/cb_2018_us_county_500k.shp", quiet = TRUE) %>%
filter(STATEFP == "26") %>%
st_transform(4326)
# Viridis discrete palette for type
pal <- colorFactor("viridis", pfas_sites_sf$type)
# Making the map
leaflet() %>%
setView(lng = -84.5, lat = 44.5, zoom = 5.5) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addPolygons(
data = mi_counties,
fillColor = "grey",
color = "black",
weight = 1,
fillOpacity = 0.3
) %>%
addCircleMarkers(
data = pfas_sites_sf,
lng = ~longitude, lat = ~latitude,
radius = 4,
fillColor = ~pal(type),
stroke = FALSE,
fillOpacity = 0.8,
popup = ~popup_label,
label = ~lapply(popup_label, htmltools::HTML)
) %>%
# Circle legend with matching size
addLegendFactor(
pal = pal,
values = pfas_sites_sf$type,
title = "Site Type",
position = "bottomright",
shape = "circle",
width = 8,
height = 8,
fillOpacity = 0.8
)
pfas_sites_sf |> janitor::tabyl(type) |> arrange(desc(n)) |> adorn_totals()
#| label: sites_circle_map
# Convert pfas_sites to sf
pfas_sites_sf <- pfas_sites %>%
mutate(
type = str_replace_all(type, "mlitary", "military"),
type = str_to_title(type),
type = case_when(type %in% c("Tannery", "Unknown", "Refinery",
"Laundromat[/]Drycleaner", "Fire Station") ~ "Other",
TRUE ~ type),
popup_label = paste0(
"<b>Facility:</b> ", facility, "<br>",
"<b>Type:</b> ", type, "<br>",
"<b>County:</b> ", county
)
)
# Load Michigan counties shapefile
mi_counties <- st_read("GeoFiles/cb_2018_us_county_500k.shp", quiet = TRUE) %>%
filter(STATEFP == "26") %>%
st_transform(4326)
# Viridis discrete palette for type
pal <- colorFactor("viridis", pfas_sites_sf$type)
# Making the map
leaflet() %>%
setView(lng = -84.5, lat = 44.5, zoom = 5.5) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addPolygons(
data = mi_counties,
fillColor = "grey",
color = "black",
weight = 1,
fillOpacity = 0.3
) %>%
addCircleMarkers(
data = pfas_sites_sf,
lng = ~longitude, lat = ~latitude,
radius = 4,
fillColor = ~pal(type),
stroke = FALSE,
fillOpacity = 0.8,
popup = ~popup_label,
label = ~lapply(popup_label, htmltools::HTML)
) %>%
# Circle legend with matching size
addLegendFactor(
pal = pal,
values = pfas_sites_sf$type,
title = "Site Type",
position = "bottomright",
shape = "circle",
width = 8,
height = 8,
fillOpacity = 0.8
)
pfas_sites_sf |> janitor::tabyl(type) |> arrange(desc(n)) |> adorn_totals()
#| label: sites_circle_map
# Convert pfas_sites to sf
pfas_sites_sf <- pfas_sites %>%
mutate(
type = str_replace_all(type, "mlitary", "military"),
type = str_to_title(type),
type = case_when(type %in% c("Tannery", "Unknown", "Refinery",
"Laundromat\\/Dry Cleaner", "Fire Station") ~ "Other",
TRUE ~ type),
popup_label = paste0(
"<b>Facility:</b> ", facility, "<br>",
"<b>Type:</b> ", type, "<br>",
"<b>County:</b> ", county
)
)
# Load Michigan counties shapefile
mi_counties <- st_read("GeoFiles/cb_2018_us_county_500k.shp", quiet = TRUE) %>%
filter(STATEFP == "26") %>%
st_transform(4326)
# Viridis discrete palette for type
pal <- colorFactor("viridis", pfas_sites_sf$type)
# Making the map
leaflet() %>%
setView(lng = -84.5, lat = 44.5, zoom = 5.5) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addPolygons(
data = mi_counties,
fillColor = "grey",
color = "black",
weight = 1,
fillOpacity = 0.3
) %>%
addCircleMarkers(
data = pfas_sites_sf,
lng = ~longitude, lat = ~latitude,
radius = 4,
fillColor = ~pal(type),
stroke = FALSE,
fillOpacity = 0.8,
popup = ~popup_label,
label = ~lapply(popup_label, htmltools::HTML)
) %>%
# Circle legend with matching size
addLegendFactor(
pal = pal,
values = pfas_sites_sf$type,
title = "Site Type",
position = "bottomright",
shape = "circle",
width = 8,
height = 8,
fillOpacity = 0.8
)
pfas_sites_sf |> janitor::tabyl(type) |> arrange(desc(n)) |> adorn_totals()
#| label: sites_circle_map
# Convert pfas_sites to sf
pfas_sites_sf <- pfas_sites %>%
mutate(
type = str_replace_all(type, "mlitary", "military"),
type = str_to_title(type),
type = case_when(type %in% c("Tannery", "Unknown", "Refinery",
"Fire Station") ~ "Other",
TRUE ~ type),
popup_label = paste0(
"<b>Facility:</b> ", facility, "<br>",
"<b>Type:</b> ", type, "<br>",
"<b>County:</b> ", county
)
)
# Load Michigan counties shapefile
mi_counties <- st_read("GeoFiles/cb_2018_us_county_500k.shp", quiet = TRUE) %>%
filter(STATEFP == "26") %>%
st_transform(4326)
# Viridis discrete palette for type
pal <- colorFactor("viridis", pfas_sites_sf$type)
# Making the map
leaflet() %>%
setView(lng = -84.5, lat = 44.5, zoom = 5.5) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addPolygons(
data = mi_counties,
fillColor = "grey",
color = "black",
weight = 1,
fillOpacity = 0.3
) %>%
addCircleMarkers(
data = pfas_sites_sf,
lng = ~longitude, lat = ~latitude,
radius = 4,
fillColor = ~pal(type),
stroke = FALSE,
fillOpacity = 0.8,
popup = ~popup_label,
label = ~lapply(popup_label, htmltools::HTML)
) %>%
# Circle legend with matching size
addLegendFactor(
pal = pal,
values = pfas_sites_sf$type,
title = "Site Type",
position = "bottomright",
shape = "circle",
width = 8,
height = 8,
fillOpacity = 0.8
)
pfas_sites_sf |> janitor::tabyl(type) |> arrange(desc(n)) |> adorn_totals()
#| label: sites_circle_map
# Convert pfas_sites to sf
pfas_sites_sf <- pfas_sites %>%
mutate(
type = str_replace_all(type, "mlitary", "military"),
type = str_to_title(type),
type = case_when(type %in% c("Tannery", "Unknown", "Refinery",
"Laundromat[/]Drycleaner", "Fire Station") ~ "Other",
TRUE ~ type),
popup_label = paste0(
"<b>Facility:</b> ", facility, "<br>",
"<b>Type:</b> ", type, "<br>",
"<b>County:</b> ", county
)
)
# Load Michigan counties shapefile
mi_counties <- st_read("GeoFiles/cb_2018_us_county_500k.shp", quiet = TRUE) %>%
filter(STATEFP == "26") %>%
st_transform(4326)
# Viridis discrete palette for type
pal <- colorFactor("viridis", pfas_sites_sf$type)
# Making the map
leaflet() %>%
setView(lng = -84.5, lat = 44.5, zoom = 5.5) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addPolygons(
data = mi_counties,
fillColor = "grey",
color = "black",
weight = 1,
fillOpacity = 0.3
) %>%
addCircleMarkers(
data = pfas_sites_sf,
lng = ~longitude, lat = ~latitude,
radius = 4,
fillColor = ~pal(type),
stroke = FALSE,
fillOpacity = 0.8,
popup = ~popup_label,
label = ~lapply(popup_label, htmltools::HTML)
) %>%
# Circle legend with matching size
addLegendFactor(
pal = pal,
values = pfas_sites_sf$type,
title = "Site Type",
position = "bottomright",
shape = "circle",
width = 8,
height = 8,
fillOpacity = 0.8
)
pfas_sites_sf |> janitor::tabyl(type) |> arrange(desc(n)) |> adorn_totals()
#| label: sites_circle_map
# Convert pfas_sites to sf
pfas_sites_sf <- pfas_sites %>%
mutate(
type = str_replace_all(type, "mlitary", "military"),
type = str_to_title(type),
type = case_when(type %in% c("Tannery", "Unknown", "Refinery",
"Laundromat/Drycleaner", "Fire Station") ~ "Other",
TRUE ~ type),
popup_label = paste0(
"<b>Facility:</b> ", facility, "<br>",
"<b>Type:</b> ", type, "<br>",
"<b>County:</b> ", county
)
)
# Load Michigan counties shapefile
mi_counties <- st_read("GeoFiles/cb_2018_us_county_500k.shp", quiet = TRUE) %>%
filter(STATEFP == "26") %>%
st_transform(4326)
# Viridis discrete palette for type
pal <- colorFactor("viridis", pfas_sites_sf$type)
# Making the map
leaflet() %>%
setView(lng = -84.5, lat = 44.5, zoom = 5.5) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addPolygons(
data = mi_counties,
fillColor = "grey",
color = "black",
weight = 1,
fillOpacity = 0.3
) %>%
addCircleMarkers(
data = pfas_sites_sf,
lng = ~longitude, lat = ~latitude,
radius = 4,
fillColor = ~pal(type),
stroke = FALSE,
fillOpacity = 0.8,
popup = ~popup_label,
label = ~lapply(popup_label, htmltools::HTML)
) %>%
# Circle legend with matching size
addLegendFactor(
pal = pal,
values = pfas_sites_sf$type,
title = "Site Type",
position = "bottomright",
shape = "circle",
width = 8,
height = 8,
fillOpacity = 0.8
)
pfas_sites_sf |> janitor::tabyl(type) |> arrange(desc(n)) |> adorn_totals()
#| label: sites_circle_map
# Convert pfas_sites to sf
pfas_sites_sf <- pfas_sites %>%
mutate(
type = str_replace_all(type, "mlitary", "military"),
type = str_to_title(type),
type = str_replace_all(type, "Laundromat/Drycleaner", "Laundromat/Dry Cleaner"),
type = case_when(type %in% c("Tannery", "Unknown",
"Refinery", "Fire Station") ~ "Other",
TRUE ~ type),
popup_label = paste0(
"<b>Facility:</b> ", facility, "<br>",
"<b>Type:</b> ", type, "<br>",
"<b>County:</b> ", county
)
)
# Load Michigan counties shapefile
mi_counties <- st_read("GeoFiles/cb_2018_us_county_500k.shp", quiet = TRUE) %>%
filter(STATEFP == "26") %>%
st_transform(4326)
# Viridis discrete palette for type
pal <- colorFactor("viridis", pfas_sites_sf$type)
# Making the map
leaflet() %>%
setView(lng = -84.5, lat = 44.5, zoom = 5.5) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addPolygons(
data = mi_counties,
fillColor = "grey",
color = "black",
weight = 1,
fillOpacity = 0.3
) %>%
addCircleMarkers(
data = pfas_sites_sf,
lng = ~longitude, lat = ~latitude,
radius = 4,
fillColor = ~pal(type),
stroke = FALSE,
fillOpacity = 0.8,
popup = ~popup_label,
label = ~lapply(popup_label, htmltools::HTML)
) %>%
# Circle legend with matching size
addLegendFactor(
pal = pal,
values = pfas_sites_sf$type,
title = "Site Type",
position = "bottomright",
shape = "circle",
width = 8,
height = 8,
fillOpacity = 0.8
)
pfas_sites_sf |> janitor::tabyl(type) |> arrange(desc(n)) |> adorn_totals()
#| label: sites_circle_map
# Convert pfas_sites to sf
pfas_sites_sf <- pfas_sites %>%
mutate(
type = str_replace_all(type, "mlitary", "military"),
type = str_to_title(type),
type = str_replace_all(type, "Laundromat/Drycleaner", "Laundromat/Dry Cleaner"),
type = case_when(type %in% c("Tannery", "Unknown",
"Refinery", "Fire Station") ~ "Other",
TRUE ~ type),
popup_label = paste0(
"<b>Facility:</b> ", facility, "<br>",
"<b>Type:</b> ", type, "<br>",
"<b>County:</b> ", county
)
)
# Load Michigan counties shapefile
mi_counties <- st_read("GeoFiles/cb_2018_us_county_500k.shp", quiet = TRUE) %>%
filter(STATEFP == "26") %>%
st_transform(4326)
# Viridis discrete palette for type
pal <- colorFactor("viridis", pfas_sites_sf$type)
# Making the map
leaflet() %>%
setView(lng = -84.5, lat = 44.5, zoom = 5.5) %>%
addProviderTiles(providers$CartoDB.Positron) %>%
addPolygons(
data = mi_counties,
fillColor = "grey",
color = "black",
weight = 1,
fillOpacity = 0.3
) %>%
addCircleMarkers(
data = pfas_sites_sf,
lng = ~longitude, lat = ~latitude,
radius = 4,
fillColor = ~pal(type),
stroke = FALSE,
fillOpacity = 0.8,
popup = ~popup_label,
label = ~lapply(popup_label, htmltools::HTML)
) %>%
# Circle legend with matching size
addLegendFactor(
pal = pal,
values = pfas_sites_sf$type,
title = "Site Type",
position = "bottomright",
shape = "circle",
width = 8,
height = 8,
fillOpacity = 0.8
)
